

Есть смысл зайти в команду RUN и поинтересоваться, как они хранили связку рефилла и базового займа.


Вопросы для обсуждения:
- Решили не создавать новый сплит для рефиллов, так как это позволит вернуться на предыдущий loan при провале ориги на рефилл.
- В одном кэшлоун сплите будет несколько сесий.
- Как связывать рефилл с базовым займом?
- Хотим сделать новый тип транзакции, которой будет закрываться базовый займ.
- При принятии рефилла, базовый переводится на PAUSE. Появляется потребность ограничить срок жизни сессии, чтобы пользователи не фродили и не пропали, после открытия сессии. Пауза нужна в том числе, чтобы быть уверенными, что с момента создания оффера по момент выплаты денег ничего не поменяется.
- Хотим добавить в продукт время жизни сессии на оригу рефилла.
- Обсудить какой будет срок жизни сессии ориджинейшена на рефилл?
- Прежде, чем клиент будет направлен в ориджинейшен рефилла, нам обязательно нужно показывать клиенту термзы рефилла (требование лигала).
- Оставляем по рефиллам финальный статус 'PAID', а не 'REFILLED' (проговорено с Дашей).
- Даша говорит, что нужно ввести отдельный тип тип транзакции DIRECT_REFILL_PAYOUT.

Вопросы:
- Скоринг будет готовить оффера на рефиллы, которые будут содержать всю сумму: долг по базовому займу + рефилл
- Для связи рефилла с базовым займом решили добавить поле refill_id в loan_data
- Что делать, если клиент не проходит оригу? не получает деньги? 
- Спросить у Олега, че за связки source_type/source_id? Непонятно откуда создалась сессия. Если мы добавим source_type, то будем понимать,о откуда  взялась сессия и application (обычный, новичок, рефилл). Там же будет заполняться source_id той сущностью, которая спровоцировала promotion_id, loan_id, split_id.
- Определяем рефилльнутый loan через application
- Связывать через loan_data -- плохая идея, так как запись в loan_data создается только после прохождения ориги. До ориги не будет связи.


Новый PBR 07.08
1. Перегружена логика сессии
2. Перегружена логика сплитования
3. У нас есть правило: 1 пользователь - 1 займ

- Хотим полностью отказаться от сущности session
- Сведение зоны ответственности сплита до распределения между OF и PL

Пользовательский state: 
1. Продукт пользователя: R2 или OF (детали маршрутизации по продуктам скипаются)
2. Status (stage): landing / origination / account / promotion
3. Data: active_loan_id/current_loan_id (может быть список), seq_id, step_id, promotion_id, application_id.

Андрей не хочет ставить loan на паузу при взятии рефилла.
Нужно в дизайне добавить кнопку отказа от ориги.

Drop будет менять статус на account, loan_id остается такой же, 

Хотим в стейте добавить информацию о том, что у клиента есть оффер. При этом оффером может быть множество.

Стейт - это реакция на ивент.


