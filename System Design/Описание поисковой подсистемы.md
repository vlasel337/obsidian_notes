### Автодополнение поисковых запросов
Пользователи могут через **food-search service** осуществлять поиск еды в реляционной БД (RDBMS выбрана так как перечень позиций ограничен). Поисковые запросы пользователей через брокер сообщений логируются сервисом **logging service** в колоночной БД.
При этом в параллель с поисковым сервисом работает сервис автодополнений **auto-complete service**, который обращается к БД с префиксным деревом (обращение происходит через кэш для увеличения отзывчивости).

В свою очередь внутри подсистемы работает сервис **auto-complete-indexing service**, который собирает статистику о пользовательских поисковых запросах и на ее основе строит префиксное дерево, данные по которому хранятся в отдельной БД. Для баз с поисковыми запросами и префиксным деревом предусмотрены дополнительные инстансы для обеспечения отзывчивости при чтении. Для БД с логами предусмотрены реплики, которые обеспечивают отказоустойчивость.

### Поиск ближайших ресторанов
Спроектирован функционал для администраторов по добавлению новых заведений посредством обращения к сервису **restaurant-add service**, который записывает заведения в реляционную БД, для которой предусмотрены распределенные шарды. Сервис **geo-indexing service** вычисляет геохэш на основании координат заведений из реляционной БД. После вычисления хэша он складывается в key-value БД.

Пользователи будут получать данные о ближайших ресторанах посредством обращения к **restaurant-search service**, который будет вытаскивать геохэш из быстрой key-value БД, а также контекст о заведении из реляционной БД через кэш.

Обращение ко всем BE сервисам из FE осуществлено через **балансировщики нагрузки**, чтоб была возможность масштабировать количество инстансов сервисов, обрабатывающих запросы. Для каждого балансировщика предусмотрен избыточный бэкап на случай отказа.

![[Search scheme.png]]