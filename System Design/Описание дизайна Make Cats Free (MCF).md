![[MCF scheme.png]]

Системой будут пользоваться три категории пользователей:
1. Клиенты (коты-тестировщики игрушек)
2. Воркеры
3. Менеджеры

### Clients
Точкой входа в сервис для клиентов будет сервис **client-dasboard-service**, в котором будет доступна информация о прошлых заказах и через который можно будет совершить новые.

Для совершения новых заказов существует **order-service**, который для поиска кандидата на заказ будет обращаться к **matching-service**. Данные об актуальных заказах будут храниться в быстрой колоночной БД. Архивные заказы будут через **order-history-service**  складываться в колоночную БД для долгосрочного хранения.

После создания заказа клиент сможет оплатить его посредством обращения к **payment-service.**

Внутри **matching-service** реализован алгоритм подбора подходящего кандидата под заказ на основе его прошлых заказов и данных из профиля. Также внутри этого сервиса вычисляется стоимость услуг.

### Workers
Данные о воркерах (ПД, а также их характеристики и рейтинг) будут заводиться и обновляться через **worker-profile-service**. Под сервисом будет реляционная БД, так как персональные данные пользователей – чувствительная информация.

Перед попаданием в пул активных воркеров кандидаты в воркеры будут проходить тесты через сервис **worker-testing-service**. Данные с ответами на вопросы тестов будут прихраниваться в колоночной БД. Агрегированные результаты тестов будут проливаться в **worker-profile-service**. 

Воркер может отсматривать доступные для него заказы, а также смотреть историю своих заказов посредством обращения к **worker-dashboard-service**. Перед началом выполнения заказа воркер может отметиться о начале заказа посредством обращения к **worker-dashboard-service**, который в свою очередь будет обращаться к **order-report-service**. В результате выполнения заказа должен генерироваться отчет по заказу, который также будет создаваться через **order-report-service**. Фотографии с фактом начала заказа и отчеты по завершению заказа будут прихраниваться в документной БД.

### Managers
Менеджеры смогут конфигурировать тесты для потенциальных воркеров в сервисе **worker-testing-service** через админ панель.

Менеджеры будут проверять качество завершенных/отмененных заказов через **quality-service**, который будет обращаться к **order-history-service**. В результате проверки заказом менеджеры могут через **quality-service** изменять рейтинг воркеров в их профилях в **worker-profile-service**.

Про функционал беттинга пока добавлять ничего не буду, так как это – шизопсихоз.

### Inventory
После создания заказа **order-service** создается ивент, который публикуется в топике в брокере сообщений. Сервис **inventory-service** вычитывает его и подготавливает для клиента необходимый инвентарь. Параллельно топик вычитывает внешний сервис **fur-tune-service**, который добавляет к заказу печенье с предсказанием. В результате подготовки полного набора инвентаря сервис **inventory-service** уведомляет сервис **order-service** о том, что воркер может забирать инвентарь для выполнения заказа.

### Notifications
Сервисы **order-service**, **payment-service**, **inventory-service**, **worker-testing-service** будут генерировать ивенты с нотификейшенами, которые будут публиковаться в топике брокера сообщений. Сервис **notification-service** будет их вычитывать, прихранивать в колоночной БД и отправлять на email адресатам через внешнего провайдера.





