Существует несколько основных способов повышения отзывчивости системы:
- кэширование данных,
- индексирование данных в БД,
- сетевой способ.
# Кэширование данных
**Кэш** – это быстрое хранилище, которое прихранивает и возвращает ранее запрошенные данные. Кэш позволяет ускорить обращения к данным за счет использования **более быстрых хранилищ** (таких, как [[Расчёт нагрузки на систему#Нагрузка на хранилище|RAM]]). 

Эффективность кэша базируется на предпосылках о том, что:
1. Более вероятно, что новые обращения будут происходить к **недавним** данным.
2. 80% запросов приходится на 20% данных (**правило Парето**).

Кэш может располагаться на любом уровне приложения:
- **На уровне запросов к балансировщику нагрузки**. [[Масштабирование систем#Балансировщик нагрузки (load balancer)|Балансировщик]] может прихранивать адреса web-страниц, к которым ранее происходило обращение.
- **На уровне запросов к FE**. Возвращаем ранее скомпилированные web-страницы.
- **На уровне запросов к BE**. При обращении к сервису данные можно кэшировать для дальнейшего переиспользования в запросах. 
- **На уровне запросов к данным в БД**. Присториваем в RAM и возвращаем ранее запрошенные данные из [[Реляционные БД|реляционной БД]].
![[Cache on different levels.png]]

## Обновление записей в кэше
Существует проблема с тем, что в кэше можно хранить только часть всех данных (~20% по правилу Парето). В этой связи возникает потребность в **обновлении кэша** более актуальными данными и очищении кэша от старых данных, которые дольше всех лежат в кэше. 

Способы обновления записей в кэше:
- **First in First out (FIFO)**. Обновление по принципу **очереди**: те записи, которые раньше попали в кэш, раньше его покидают кэш.
- **First in First out (LIFO)**. Обновление по принципу стэка: кэшируем более старые записи, а новые записи покидают кэш.
- **Least Recently Used (LRU)**. При необходимости освободить место в кэше удаляются записи, к которым не происходило обращение дольше всего.
- **Most Recently Used (MRU)**. При необходимости освободить место в кэше удаляются записи, к которым происходило самое недавнее обращение.
- **Least Frequently Used (LFU)**. Ведется счет обращения к записям за определенный период. Удаляются самые непопулярные.
- **Random Replacement (RR)**. Записи удаляются из кэша случайно.

Оптимальным вариантом считается гибридная схема обновления записей в кэше на основе комбинации способов **Least Recently Used (LRU)** и **Least Frequently Used (LFU)**.

## Инвалидация кэша
**Инвалидация кэша** – это способы борьбы с ситуацией, когда после добавления записи в кэш происходит обновления записи на источнике (например в БД), и запись в кэше перестает быть валидной.

Способы инвалидации кэша:

| Способ             | Описание                                                                                                               | Плюсы                                                                   | Минусы                                                                                                         |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| Сквозная запись    | Чтение данных происходит из кэша. Запись данных происходит транзакционно одновременно и в кэш, и на источник.          | **Гарантирована консистентность** данных в кэше и на источник           | Запись данных **происходит медленнее** из-за усложнения операции.                                              |
| Запись в обход     | Данные записываются сразу в источник. После чего происходит синхронизация популярных записей между источником и кэшом. | Кэш не нагружается записью невостребованных данных.                     | Свежие данные попадут в кэш только после синхронизации, поэтому могут возникнуть ситуации чтения из источника. |
| Реверсивная запись | Данные сперва записываются в кэш, после чего кэш переносит данные в источник.                                          | Ускоряется скорость записи (так как кэш – это более быстрое хранилище). | Есть риск потери данных, не перенесенных в источник из-за провала синхронизации.                               |
## Использование CDN в качестве кэша
**Content Delivery Network (CDN)** – это распределенные хранилища данных, покрывающие различные регионы, которые можно считать отдельным особым видом кэша. 
Примеры: Cloudflare, AWS Cloudfront, Google Cloud CDN, Microsoft Azure.

Инстансы CDN распределены по большинству популярных регионов по всему миру. Они используются в приложениях с часто запрашиваемыми медиафайлами: аудио, фото, видео.
При обращении к файлу сервис проверяет, на каком ближайшем к пользователю сервере находится файл после чего отдает его пользователю. Если же файла нет на сервере поблизости, CDN обратится к центральному серверу.

# Индексирование БД
Индексирование БД – это способ ускорения обращения к данным в исходной БД.

Способы
Бинарный поиск по отсортированному бинарному дереву за время log<sub>n</sub>

Плюсы индексирования:
- 1]

Минусы индексирования:
- 1]


